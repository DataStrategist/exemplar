# exemplar

<!-- badges: start -->

[![R-CMD-check](https://github.com/mdneuzerling/exemplar/workflows/R-CMD-check/badge.svg)](https://github.com/mdneuzerling/exemplar/actions)
[![Last commit](https://img.shields.io/github/last-commit/mdneuzerling/lambdr/main.svg)](https://github.com/mdneuzerling/exemplar/tree/main)
[![Codecov test coverage](https://codecov.io/gh/mdneuzerling/lambdr/branch/main/graph/badge.svg)](https://app.codecov.io/gh/mdneuzerling/exemplar?branch=main)
[![license](https://img.shields.io/badge/license-MIT-lightgrey.svg)](https://choosealicense.com/licenses/mit/)

<!-- badges: end -->

Exemplar generates dependency-free validation functions to make sure one object looks like another (its _exemplar_). The package contains only one function, `exemplar`. Consider the validation function generated by using `mtcars$gear` as an exemplar:

```r
exemplar(mtcars$gear)
```

This will print the below function which can be modified and used to make sure that any new data meets the same conditions as `mtcars$gear`:

```r
validate_mtcars_gear <- function(data) {
  stopifnot(exprs = {
    is.double(data)
    !any(is.na(data) | is.null(data))
    # Duplicate values were detected so this assertion has been disabled:
    # !any(duplicated(data))
    min(data, na.rm = TRUE) > 0 # all positive
    # Uncomment or modify the below range assertions if needed:
    # max(data, na.rm = TRUE) <= 5
    # 3 <= min(data, na.rm = TRUE)
    # Uncomment or modify the below deviance from mean assertions if needed.
    # The mean is 3.69 and the standard deviation is 0.74:
    # max(data, na.rm = TRUE) <= 3.69 + 4 * 0.74
    # 3.69 - 4 * 0.74 <= min(data, na.rm = TRUE)
  })
  invisible(TRUE)
}
```

The generated validation function, `validate_mtcars_gear` checks that:

* the input is a `double`
* there are no missing values
* all values are positive

If all conditions are met, the function will invisibly return `TRUE`. Otherwise, it will error. The function can be defined with `eval` and `parse`:

```r
eval(parse(text = exemplar(mtcars$gear)))
validate_mtcars_gear(c(mtcars$gear, NA))
```
```
Error in validate_mtcars_gear(c(mtcars$gear, NA)) : 
  !any(is.na(data) | is.null(data)) is not TRUE
```

Some checks are commented out. This is because the exemplar does not meet the criteria (eg. no duplicate values) or the checks are too specific to be used by default (range checks). The intention is that users will modify the validation functions to meet their needs before placing them in pipelines and scripts.

A common use case might be machine learning with a train/test data split. A validation function can be generated using the training data as the _exemplar_, and then applied to the test data.

The functions produced by `exemplar` require at least R 3.5 (due to improvements made to `stopifnot`) but otherwise requires no dependencies. That is, `exemplar` generates functions that do not need `exemplar` or any other packages to run.

## Installation

You can install the development version of exemplar from [GitHub](https://github.com/) with:

```r
# install.packages("devtools")
devtools::install_github("mdneuzerling/exemplar")
```
